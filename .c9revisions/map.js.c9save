{"ts":1341839083068,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var m;\r\nvar tid = 3831965;\r\nvar gwid = 3847334;\r\nvar geocoder = new google.maps.Geocoder();\r\nvar zoom = 8;\r\nvar center = new google.maps.LatLng(42.04113400940814,-71.795654296875);\r\nvar marker;\r\nvar mainLayer,greenWay;\r\n\r\n$(function() {\r\n        $( \"#tabs\" ).tabs({\r\n        \tcollapsible: true,\r\n            selected: -1\r\n\t\t});\r\n        $( \"input:submit,input:reset\" ).button();\r\n        $('input, textarea').placeholder();\r\n        fusion();\r\n        popLists();\r\n\t});\r\nfunction fusion() {\r\n    \r\n  m = new google.maps.Map(document.getElementById('map'), {\r\n      center: center,\r\n      zoom: zoom,\r\n      mapTypeId: 'roadmap'\r\n    });\r\n    \r\n /*greenWay =   new google.maps.FusionTablesLayer({\r\n  query: {\r\n    select: 'geometry',\r\n    from: gwid,\r\n    where: \"'Preferred' ='Y'\"\r\n  },\r\n  styles: [{\r\n    polylineOptions: {\r\n      strokeColor: \"#F6FF00\",\r\n      strokeOpacity: 0.6,\r\n      strokeWeight:6\r\n    }\r\n  }]\r\n});*/\r\ngreenWay = new google.maps.FusionTablesLayer(gwid);\r\n mainLayer = new google.maps.FusionTablesLayer(tid);\r\n greenWay.setQuery(\"SELECT 'geometry' FROM \" + gwid + \" WHERE 'Preferred' ='Y'\" );\r\n  mainLayer.setQuery(\"SELECT 'geometry' FROM \" + tid + \" WHERE 'Status' like 'Constructed (existing)'\");\r\n  greenWay.setMap(m);\r\n  greenWay.setOptions({suppressInfoWindows:true});\r\n  mainLayer.setMap(m);\r\n  }\r\n\r\nfunction geocode() {\r\n     var address = document.getElementById(\"address\").value;\r\n    geocoder.geocode( { 'address': address}, function(results, status) {\r\n      if (status == google.maps.GeocoderStatus.OK) {\r\n        m.setCenter(results[0].geometry.location);\r\n        m.setZoom(14);\r\n     marker = new google.maps.Marker({\r\n            map: m, \r\n            position: results[0].geometry.location\r\n        });\r\n      } else {\r\n        alert(\"Geocode was not successful for the following reason: \" + status);\r\n      }\r\n    });\r\n}\r\n\r\nfunction resetgeo() {\r\n    \r\n    m.setCenter(center);\r\n    m.setZoom(zoom);\r\nmarker.setMap(null);\r\n}\r\n\r\n\r\n    \r\n    google.load('visualization', '1', {});\r\n    \r\nfunction popLists(){    \r\n    MakePopList('NewType',getFacTypeData);\r\n   MakePopList('Status',getStatusData);\r\n  \r\n    }\r\n\r\nfunction MakePopList(columnName,callfunc){\r\n var queryText = encodeURIComponent(\"SELECT \" +columnName + \", COUNT() FROM \" + tid + \" GROUP BY \" +columnName);\r\n    var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq='  + queryText);\r\n    query.send(callfunc);\r\n\t}\r\n    \r\nvar getFacTypeData = MakeData(\"facType\",\" 'NewType' like '\");\r\nvar getStatusData = MakeData(\"facStatus\",\" 'Status' like '\");\r\n\r\nfunction MakeData(selectID,querryText){\r\n\r\nfunction getData(response) {\r\n  // Get the number of rows\r\nvar numRows = response.getDataTable().getNumberOfRows();\r\n  \r\n  // Add options to the select menu based on the results\r\n var typeSelect = document.getElementById(selectID);  \r\n  for(i = 0; i < numRows; i++) {\r\n      var ftData = response.getDataTable().getValue(i, 0);\r\n     \r\n    \r\n     \r\n      var newoption = document.createElement('option');\r\n      newoption.setAttribute('value',querryText + ftData + \"'\");\r\n    newoption.innerHTML = ftData;\r\n     if (ftData == 'Constructed (existing)')\r\n     { newoption.setAttribute(\"selected\",\"selected\");}\r\n    typeSelect.appendChild(newoption);\r\n  }  \r\n}\r\nreturn getData;\r\n}    \r\n    \r\n    \r\n\r\nfunction changeMap() {\r\n   var facType = document.getElementById('facType').value.replace(\"'\", \"\\\\'\");\r\n   var statusType = document.getElementById('facStatus').value.replace(\"'\", \"\\\\'\");\r\n   var andz = \" and \";\r\n if(facType === \"\" ||statusType === \"\")\r\n {andz = \"\";}\r\n  mainLayer.setQuery(\"SELECT 'geometry' FROM \" + tid + \" WHERE \" + facType + andz + statusType);\r\n \r\n}"]],"start1":0,"start2":0,"length1":0,"length2":3698}]],"length":3698}
